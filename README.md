# Honeyfish Chess AI

![Demo](img/henyfishUCI2 vs henyfishUCI (1_2-1_2) 2025-09-11 20-47-19_2.gif)


## プロジェクト概要
特定の戦術（クイーンサイド・キャスリング）を判断するCNN(SE-ResNet)モデルを搭載したチェスAIです。

シンプルな探索エンジン（v0.2）と、伝統的なαβ探索エンジン（v0.3）の2種類を実装。両者を比較分析することで、AIの性能と機械学習モデルの挙動におけるトレードオフを明らかにしました。




## 技術スタック


**言語:** Python

**機械学習:** PyTorch (SE-ResNet)、データセットあり(LichessEliteDataBase)、教師あり(stockfish)、二値分類

**チェスエンジン:** UCIプロトコル準拠




## アプローチと成果

***アーキテクチャの進化***

**v0.2:** CNNの評価値に基づくシンプルなTop-K探索。

**v0.3:** 静止探索や反復深化などを備えた、より堅牢な αβ探索 へと改良。




## 成果

自己対戦（400局）の結果、v0.3がv0.2をレートで大幅に上回ることを確認しました。

一方で、レート向上と引き換えに、v0.3は目的の戦術（クイーンサイド・キャスリング）をほとんど実行しないという、興味深い結果が得られました。これは、探索アルゴリズムの指し手評価が、CNNモデルの判断より優位に働いたためです。




## 直面した課題と学び

**課題：**モデルの予測性能が実用レベルに達しない。

学習時、モデルのAUC（Area Under the Curve）スコアは99%と良好でしたが、F1スコアが0.65で頭打ちになりました。




**原因と学び：**原因は、学習データが「陽性:陰性 = 1:80」という極端なクラス不均衡状態にあったことでした。

この経験から、不均衡データ下では見かけ上の精度（AUCやAccuracy）に惑わされず、F1スコアのような実践的な評価指標を重視することの重要性を学びました。これは、機械学習プロジェクトにおけるデータ前処理と評価指標選択の難しさを示す好例です。
またその他、Trobuleshooting.mdに纏めています。



## 今後の展望
このプロジェクトで得た知見を活かし、今後はモンテカルロ木探索（MCTS）や強化学習を用いたアプローチに挑戦したいと考えています。




##引用エンジン、データ##

**LichessEliteDataBaseよりZIP形式で圧縮されたPGNファイル**

https://database.nikonoel.fr/


**stockfishより教師エンジンVer17.1**

https://stockfishchess.org/